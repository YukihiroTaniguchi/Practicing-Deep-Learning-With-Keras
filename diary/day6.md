### 181201(Sat)  
p.96 - p.134
chapter4.py : L1-L76
chapter5.py : L1-L74
##### *Remember me*  
畳み込みニューラルネットワーク(CNN)  
- 畳み込み層(Conv2D層)  
-> 特定のパターンを学習したら、他の場所に出現した同様のパターンを認識できる  
-> 小さな局所的パターンからより大きなパターンを学習し、資格概念の抽象化を行うことが可能

幅、高さ、チャネル(深さ)を持つ  
最初の入力層でチャネルはRGBのカラーチャネル(3)だが、パターンの有無を表すもの(より多くのチャネルを持つ-32とか)になる  
-> 特徴マップ(特徴(パターン)がどこに現れているかを示す。チャネルによって示す特徴が異なる)

```python
Conv2D(output_depth, (window_height, window_width))
```
入力特徴マップ  
↓  
3 \* 3 とか 5 \* 5 の入力パッチをずらしていく  
↓  
それぞれの入力パッチを1次元ベクトルに変換する  
↓  
1次元ベクトルをまとめて出力特徴マップを生成

周辺効果  
5 \* 5 の特徴マップに 3 \* 3 の入力パッチを当てて作られるタイルは 3 \* 3 だけ  
-> (幅-1) \* (高さ-1) の大きさになって少し小さくなる  

パディング  
周辺効果によって出力特徴マップの空間次元が損なわれるのを避ける  
->入力特徴マップの上下左右に1行ずつ追加していく

```python
padding="valid"(なし)または"same"(上下左右に1行ずつ追加)
```

ストライド  
ずらす値を変更する(デフォルトは1)

- 最大値プーリング演算  
2 \* 2 ウインドウとストライド2でパッチの最大値をダウンサンプリングする  
->サイズが半分になる

```python
model.add(layers.MaxPooling2D((2, 2)))
```
->最大値プーリング演算を用いてダウンサンプリングをすることで
1. 処理対象の特徴マップの係数を減らすことができる
2. 連続する畳み込みが調べるウィンドウを徐々に大きくすることで、空間フィルタ階層を抽出できる
